<%#= form_with 'この本を本棚に入れる' %>
    <input id="isbn" type="hidden" disabled="disabled" name="isbn" value="<%= params[:isbn] %>" autofocus>
<%# end %>
<table class=book_detail>
    <tr>
        <th width="20%"></th>
        <td id="thumbnail"></td>
    </tr>
    <tr>
        <th>書籍名：</th>
        <td><p id="title" type="text" disabled="disabled" name="title" value=""></p></td>
    </tr>
    <tr>
        <th>出版社：</th>
        <td><p id="publisher" type="text" name="publisher" value=""></p></td>
    </tr>
    <tr>
        <th>巻：</th>
        <td><p id="volume" type="text" name="volume" value=""></p></td>
    </tr>
    <tr>
        <th>シリーズ：</th>
        <td><p id="series" type="text" name="series" value=""></p></td>
    </tr>
    <tr>
        <th>著者：</th>
        <td><p id="author" type="text" name="author" value=""></p></td>
    </tr>
    <tr>
        <th>出版日：</th>
        <td><p id="pubdate" type="text" name="pubdate" value=""></p></td>
    </tr>
    <tr>
        <th>詳細：</th>
        <td><p id="description" type="text" name="description" value=""></p></td>
    </tr>
</table>

<script>
$(document).on('turbolinks:load', function() {
    const isbn = $("#isbn").val();
    const url = "https://api.openbd.jp/v1/get?isbn=" + isbn;
    $.getJSON(url, function(data) {
        if (data[0] == null) {
        } else {
            if (data[0].summary.cover == "") {
                $("#thumbnail").html('<img src=\"\" />');
            } else {
                $("#thumbnail").html('<img src=\"' + data[0].summary.cover + '\" style=\"border:solid 1px #000000\" />');
            }
            $("#title").text(data[0].summary.title);
            $("#publisher").text(data[0].summary.publisher);
            $("#volume").text(data[0].summary.volume);
            $("#series").text(data[0].summary.series);
            $("#author").text(data[0].summary.author);
            $("#pubdate").text(data[0].summary.pubdate);
            $("#cover").val(data[0].summary.cover);
            $("#description").text(data[0].onix.CollateralDetail.TextContent[0].Text);
        }
    });
});
</script>
